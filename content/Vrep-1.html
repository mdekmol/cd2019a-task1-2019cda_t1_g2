<!doctype html>
<html><head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>2019cda_t1_g2</title> <link rel="stylesheet" type="text/css" href="./../static/cmsimply.css">
<script src="tipuesearch_content.js"></script>
<script src="./../static/jquery.js"></script>
<link rel="stylesheet" href="./../static/tipuesearch/css/tipuesearch.css">
<script src="./../static/tipuesearch/tipuesearch_set.js"></script>
<script src="./../static/tipuesearch/tipuesearch.min.js"></script>

<script type="text/javascript" src="./../static/syntaxhighlighter/shCore.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushJScript.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushJava.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushPython.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushSql.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushXml.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushPhp.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushLua.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushCss.js"></script>
<script type="text/javascript" src="./../static/syntaxhighlighter/shBrushCSharp.js"></script>
<link type="text/css" rel="stylesheet" href="./../static/syntaxhighlighter/css/shCoreDefault.css"/>
<script type="text/javascript">SyntaxHighlighter.all();</script>

<!-- for LaTeX equations 暫時不用
<script src="https://scrum-3.github.io/web/math/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
<script type="text/javascript">
init_mathjax = function() {
    if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
            },
            displayAlign: 'left', // Change this to 'center' to center equations.
            "HTML-CSS": {
                styles: {'.MathJax_Display': {"margin": 0}}
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
}
init_mathjax();
</script>
-->
<!-- 暫時不用
<script src="./../static/fengari-web.js"></script>
<script type="text/javascript" src="./../static/Cango-13v08-min.js"></script>
<script type="text/javascript" src="./../static/CangoAxes-4v01-min.js"></script>
<script type="text/javascript" src="./../static/gearUtils-05.js"></script>
-->
<!-- for Brython 暫時不用
<script src="https://scrum-3.github.io/web/brython/brython.js"></script>
<script src="https://scrum-3.github.io/web/brython/brython_stdlib.js"></script>
-->

<script type="text/javascript">
/*shorthand of $(document).ready(function(){};); */
$(function(){
    $("ul.topmenu> li:has(ul) > a").append('<div class="arrow-right"></div>');
    $("ul.topmenu > li ul li:has(ul) > a").append('<div class="arrow-right"></div>');
});
function doSearch() {
     $('#tipue_search_input').tipuesearch({
        newWindow: true, minimumLength: 2
     });
}
$(document).ready(doSearch);
</script>

</head><header><h1>產品協同設計第二組</h1> <confmenu>
<ul>
<li><a href="index.html">Home</a></li>
<li><a href="sitemap.html">Site Map</a></li>
<li><a href="./../reveal/index.html">reveal</a></li>
<li><a href="https://cda2019g2.blogspot.com/">blog</a></li>

</ul>
</confmenu></header>
<div class='container'><nav><ul id='css3menu1' class='topmenu'><div class="tipue_search_group"><input style="width: 6vw;" type="text" name="q" id="tipue_search_input" pattern=".{2,}" title="Press enter key to search" required></div><li><a href='各組期末報告說明.html'>各組期末報告說明</a><li><a href='執行規劃.html'>執行規劃</a><ul><li><a href='手足球系統模擬.html'>手足球系統模擬</a></li></ul><li><a href='設計與繪圖.html'>設計與繪圖</a><ul><li><a href='零組件尺寸分析.html'>零組件尺寸分析</a><li><a href='參數設計與繪圖.html'>參數設計與繪圖</a><li><a href='細部設計與 BOM.html'>細部設計與 BOM</a></li></ul><li><a href='V-rep 動態模擬.html'>V-rep 動態模擬</a><ul><li><a href='Vrep-1.html'>Vrep-1</a><ul><li><a href='Vrep-2-1.html'>Vrep-2-1</a></li></ul><li><a href='送球機構設計與模擬.html'>送球機構設計與模擬</a><li><a href='系統功能展示.html'>系統功能展示</a><li><a href='回擊系統模擬.html'>回擊系統模擬</a></li></ul><li><a href='結案報告.html'>結案報告</a><ul><li><a href='專案口頭簡報.html'>專案口頭簡報</a><li><a href='專案報告書.html'>專案報告書</a><ul><li><a href='編輯報告書.html'>編輯報告書</a></li></li></ul></ul><li><a href='第十周前.html'>第十周前</a><ul><li><a href='簡介.html'>簡介</a><ul><li><a href='組員名單與網站.html'>組員名單與網站</a></li></ul><li><a href='Task-1.html'>Task-1</a><ul><li><a href='自定義隨身系統.html'>自定義隨身系統</a><li><a href='隨機分組介面成品.html'>隨機分組介面成品</a><li><a href='分組程式修正.html'>分組程式修正</a><li><a href='ungit使用手冊.html'>ungit使用手冊</a><li><a href='問題.html'>問題</a></li></ul><li><a href='Task-2.html'>Task-2</a><ul><li><a href='Vrep-2.html'>Vrep-2</a><li><a href='Vrep-2-2.html'>Vrep-2-2</a><li><a href='Onshape.html'>Onshape</a><li><a href='Extra-add.html'>Extra-add</a><li><a href='Final-handball.html'>Final-handball</a></li></ul><li><a href='期中報告.html'>期中報告</a><li><a href='Virtualbox虛擬主機網路設定.html'>Virtualbox虛擬主機網路設定</a><li><a href='換行code 改寫.html'>換行code 改寫</a><li><a href='圖形簡化.html'>圖形簡化</a></li></ul><li><a href='第十二周.html'>第十二周</a><li><a href='第十三周.html'>第十三周</a><li><a href='簡化組合件.html'>簡化組合件</a></li></ul></nav><section><div id="tipue_search_content">V-rep 動態模擬 << <a href='V-rep 動態模擬.html'>Previous</a> <a href='Vrep-2-1.html'>Next</a> >> Vrep-2-1<br /><h1>Vrep-1</h1>
<p><a href="./../downloads/bubbleRob.7z" title="BubbleRob">BubbleRob</a></p>
<p><a href="http://www.coppeliarobotics.com/helpFiles/en/bubbleRobTutorial.htm">教學WEB</a></p>
<p><img caption="false" height="668" src="./../images/Test.gif" width="1000"/></p>
<p>可作動</p>
<p>BubbleRob操作手冊</p>
<p>1.建立BubbleRob本體<br/>新增一個<span>Sphere</span>，<span>X-size</span>為<span>0.2(</span>單位為m)<br/>在<span style="color: #ff0000;"><strong>object common properties</strong></span>下的<strong><span style="color: #ff0000;">object special properties</span></strong>(特殊屬性參數)將<strong><span style="color: #ff0000;">Collidable(可碰撞)、Measurable(可測量)、Renderable(可渲染)、Detectable(可檢測)</span></strong>都打勾，將本體位置設定在Z軸(Along Z)0.02(必須確認本體是依照world去移動)<br/>接著在選單雙擊Sphere將物件名稱改為BubbleRob就完成本體設定。</p>
<p><img alt="" height="92" src="./../images/特殊屬性.png" width="300"/></p>
<p>2.建立Proxmity sensor(接近傳感器)<br/>在選單中建立一個<strong><span style="color: #ff0000;">Proximity sensor</span></strong>且選為<strong><span style="color: #ff0000;">Cone type</span></strong>(錐形)</p>
<p>將sensor利用旋轉功能在<span>Around Y及Z</span>輸入<span>90</span><br/>位置為<strong><span style="color: #ff0000;">X-coord</span></strong>輸入<span>0.1</span>及<strong><span style="color: #ff0000;">Z-coord</span></strong>輸入<span>0.12</span></p>
<p><img alt="" height="158" src="./../images/旋轉.png" width="300"/></p>
<p><img alt="" height="161" src="./../images/位置.png" width="300"/></p>
<p>接著設定sensor感應範圍，在選單點擊感測器符號開啟它的設定框，點擊<strong><span style="color: #ff0000;">show volume </span></strong></p>
<p><strong><span style="color: #ff0000;">parameter</span></strong>(體積參數)開啟選單設定<span style="color: #ff0000;">Offset=0.005、Angle=30、Range=0.15</span></p>
<p><img alt="" height="571" src="./../images/sensor參數.png" width="350"/></p>
<p>點擊<strong><span style="color: #ff0000;">Show detection parameters</span></strong>(檢測參數)，將<strong><span style="color: #ff0000;">"Don't allow detections if distance smaller than"</span></strong>選項取消打勾。</p>
<p>將感測器名稱設定為<span style="color: #ff0000;">bubbleRob_sensingNose</span>，就完成感測器設定了。</p>
<p>在<span>Scene hireachy</span>(場景等級)將完成設定的sensor放在bubbleRob下</p>
<p>最後將兩項物件<strong><span style="color: #ff0000;">Edit-&gt;"Make last selected object parent"</span></strong>連結成一個物件。</p>
<p>3.建立bubbleRob的輪子</p>
<p>建立一個<span>cylinder</span>尺寸為(0.08,0.08,0.02)，跟本體一樣將<strong><span style="color: #ff0000;">object common properties</span></strong>內的特殊屬性都打開，設定位置(0.05,0.1,0.04)和旋轉(-90,0,0)，此物件命名為<strong><span style="color: #ff0000;">bubbleRob_leftWheel</span></strong>，然後將完成的物件複製一份且將位置參數Y設定為-0.1，此物件命名為<strong><span style="color: #ff0000;">bubbleRob_RightWheel</span></strong></p>
<p>設定<span>joint</span>(motor)<br/><strong><span style="color: #ff0000;">Add-&gt;joint-&gt;Revolute</span></strong>(迴轉)建立一個軸，建立完成按住ctrl選擇剛剛的<span>bubbleRob_leftWheel</span>然後在<span>postion</span>(位置)及<span><span> </span>orientation</span>(方向)內選擇<span>apply to selection</span>來複製輪子的參數，這樣軸的位置就會跟左邊輪子一樣了。<br/>點擊開啟軸參數的設定框，將<span style="color: #ff0000;"> Show dynamic parameters</span>(動態參數)內的<span style="color: #ff0000;">enable the motor</span>以及底下的<span style="color: #ff0000;">Lock motor when target velocity is zero</span>都打勾，完成左邊輪軸設定後，用同樣方式製作右輪軸。</p>
<p>最後將輪子層級放置在輪軸底下，輪軸層級則置於本體下</p>
<p><img alt="" height="85" src="./../images/輪軸.png" width="192"/></p>
<p>4.建立slider(滑塊)<br/>開始模擬後發現機器人會向後翻轉，因為少了第三個接地點<br/>建立一個圓形物件(設定0.05)，一樣打開所有特殊屬性，將此物件命名為<span style="color: #ff0000;"> bubbleRob_slider</span>，在<span style="color: #ff0000;">shape dynamics properties</span>裡將物件設定為<span>無摩擦</span>。</p>
<p>摩擦力相關的係數都調成0</p>
<p><img alt="" height="123" src="blob:https://127.0.0.1:9443/c2e15082-853c-4bee-906c-d3c649b74a0c" width="504"/></p>
<p>接著建立<span style="color: #ff0000;"><strong>Force sensor</strong></span>(力感測器)命名為<span style="color: #ff0000;"><strong>bubbleRob_connection</strong></span>，將它往上提0.05<br/>，再跟剛剛的滑塊接合成一個物件，這個物件的位置設定X=(-0.07)，此物件的層級則放在bubbleRob底下，這樣就完成第三個接地點了，但是執行模擬後會發現滑塊會微微震動，那是因為滑塊跟本體互相碰撞了，為了避免這種狀況，開啟滑塊及本體的<span style="color: #ff0000;"><strong>shape dynamics properties</strong>將<strong>local respondable mask</strong></span>分別設定為00001111及<br/>11110000這樣兩個物件就不會互相碰撞了。</p>
<p>滑塊設定</p>
<p><span><img alt="" height="136" src="./../images/本體碰撞1.png" width="350"/></span></p>
<p><span>本體設定</span></p>
<p><img alt="" height="121" src="./../images/本體碰撞2.png" width="350"/></p>
<p>5.增加穩定性(stability)及目標速度(<span>Target velocity</span>)測試<br/>點擊dynamic對話框內的<strong><span style="color: #ff0000;">M=M*2</span></strong>選項三次將輪子以及第三個支點的重量變成8倍，接著在軸的dynamic對話框將<strong><span style="color: #ff0000;">Target velocity</span></strong>設至50後開始演算，會發現bubbleRob會穩定的直線前進最後掉出平台，然後再將速度重置為0，測試就完成了。</p>
<p><img alt="" height="86" src="blob:https://127.0.0.1:9443/c8822d34-a2c9-4576-b76c-53b149c13d11" width="367"/></p>
<p>6.<span>collection object</span>(物品集)及<span>Calculation module properties</span>(計算模組)<br/>在collection對話框內用<strong><span style="color: #ff0000;">Add new collection</span></strong>，新增的集合是空的，將列表上的bubbleRob選擇後點選Add加進collection，命名為<span style="color: #ff0000;"><span> </span>bubbleRob_collection</span><span> </span>，這樣bubbleRob底下的零件都包含集合裡。<br/>在選單點選<span>Calculation module</span>在<span>distance</span>(距離)下<strong><span style="color: #ff0000;">Add new distance object</span></strong><span style="color: #ff0000;">，</span>選擇剛剛新增的<span style="color: #ff0000;">bubbleRob_collection</span>及<span style="color: #ff0000;">all other measurable objects in the scene</span>，<br/>命名為<span style="color: #ff0000;">bubbleRob_distance</span>，這個設定在之後會測量本體以及其他可碰撞物件之間的最小距離。</p>
<p><img alt="" height="444" src="./../images/Calculation Modules.png" width="382"/></p>
<p>7.Graph(圖表)設定<br/>新增一個Graph命名為<span style="color: #ff0000;">bubbleRob_graph</span>在列表上放置於bubbleRob底下將graph位置設定在(0,0,0.005)開啟graph properties，將<span style="color: #ff0000;">Display XYZ-planes</span>選項取消打勾，接著<span style="color: #ff0000;">Add new data stream to record</span>，視窗上方<span style="color: #ff0000;">(Data stream type)</span>選擇<span style="color: #ff0000;">Object: absolute x-position</span>下方<span style="color: #ff0000;">(Object / item to record)</span>選擇<span style="color: #ff0000;">bubbleRob_graph</span>，在<span style="color: #ff0000;">Data stream recording list</span>會出現剛剛新增的設定，Y軸跟Z軸也用同樣方式做設定。</p>
<p>為了能夠測量機器人跟環境之間的最小距離再新增一個設定上面選擇<span style="color: #ff0000;">Distance:segment length</span>下方選擇<span style="color: #ff0000;">bubbleRob_distance</span>。</p>
<p><img alt="" height="117" src="blob:https://127.0.0.1:9443/f9cfd1c1-a17b-4162-a526-d815d0c15f5f" width="368"/></p>
<p>將XYZ軸及距離設定分別命名為<span><span style="color: #ff0000;">bubbleRob_xpos、bubbleRob_ypos、bubbleRob_zpos、 bubbleRob_obstacle_dist</span>。</span></p>
<p><span><img alt="" height="600" src="./../images/graph set.png" width="379"/></span></p>
<p>選擇bubbleRob_xpos在底下的<span style="color: #ff0000;"><strong>Time graph properties</strong></span>將Visible取消掉，其他兩軸也用相同方式操作。</p>
<p>接著在<span style="color: #ff0000;">Edit 3D curves</span>點選<span style="color: #ff0000;"><span> </span>Add new curve</span>設定如圖</p>
<p><img alt="" height="145" src="./../images/curve.png" width="282"/></p>
<p><span style="color: #ff0000;">Curve width</span>(線寬)設定為4，然後改成<span style="color: #ff0000;">Relative to world</span>，完成後測試就會發現機器人的路徑會以線顯示在螢幕上。</p>
<p>8.建立cylinder</p>
<p>增加數個(0.1,0.1,0.2)的cylinder包圍bubbleRob，將cylinder的特殊屬性參數全部打開，移動cylinder途中按著shift可以進行更細微的移動，按住ctrl則可以讓物件可以在正交方向移動。</p>
<p>9.model設定<br/>選擇bubbleRob後在<span style="color: #ff0000;"><strong>object common properties</strong></span>內將<span style="color: #ff0000;"><strong>Object is model base</strong></span>和<span style="color: #ff0000;"><strong>Object/model can transfer or accept DNA</strong></span>都打勾，這樣bubbleRob邊界框就包含底下所有的物件在內了。</p>
<p><img alt="" height="618" src="./../images/model base.png" width="388"/></p>
<p>接著將兩個joint、sensor跟graph都選起來然後將參數設定<span style="color: #ff0000;"><strong>ignored by model bounding box</strong></span>，讓模型的邊界框略過sensor跟joint然後將joint跟sensor的camera visibility layer 2取消打勾改為打勾10，這樣在畫面上就不會看見軸跟sensor範圍了，最後將感測器、兩個輪子、支點、圖表的<span style="color: #ff0000;"><strong>Select base of model instead</strong></span>都打勾，這項設定讓我們只能一次移動整個機器人而不是單個零件，能避免定位好的零件被移動。</p>
<p><img alt="" height="215" src="./../images/3.6.1.png" width="382"/></p>
<p><span>(vrep版本3.6.1沒有<span style="color: #ff0000;"><strong>Don't show as inside model selection</strong></span>按鈕)</span></p>
<p>10.感測器(vision sensor)<br/>增加一個新的感測器，位置、角度跟BubbleRob's proximity sensor同樣，在畫面上點選增加<span>Perspective type</span>的sensor，然後放到proximity sensor底下，新的sensor設定如下</p>
<p><img alt="" height="542" src="./../images/sensor.png" width="385"/></p>
<p>接著點擊<span style="color: #ff0000;">Show filter dialog</span>開啟filter對話框，選擇<span style="color: #ff0000;">Edge detection on work image</span>然後按<span>Add</span>，新增的過濾組件要上移至第二層，移動完後點擊兩下剛剛設定的組件將<span style="color: #ff0000;">Threshold</span>(閾值)設定為0.2，設定到這邊基本上就完成了。</p>
<p><img alt="" height="368" src="./../images/threshold.png" width="385"/></p>
<p>完成sensor設定後新增一個<span style="color: #ff0000;">floating view</span>然後在它上面右鍵選擇<span style="color: #ff0000;">(view-&gt;Associate view with selected vision sensor)</span>將視窗綁定到剛剛設定完的sensor上(操作中間要確保sensor是被選擇的狀況)，接著試著開始模擬，視窗上能夠看見目標就成功了。</p>
<p><img alt="" height="219" src="./../images/vision sensor2.png" width="374"/></p>
<p>11.程式:<span>位於工具列的script功能可以編輯code</span><span></span></p>
<p><img alt="" height="49" src="./../images/icon.png" width="49"/></p>
<p>最後的步驟要將code放進完成的模型內，選擇bubbleRob點選(<span style="color: #ff0000;">Add-&gt;Associated child script --&gt; Non threaded</span>)</p>
<p><img alt="" height="328" src="./../images/child script.png" width="491"/></p>
<p>新增一個<span style="color: #ff0000;"><strong>non-threaded child script</strong></span>，接著點選bubbleRob旁邊的圖示(如附圖)<span>就能打開script，將code複製在原本的code後面關掉視窗就完成了。</span></p>
<p><span><img alt="" height="62" src="./../images/icon2.png" width="198"/></span></p>
<p>需注意code內部 </p>
<p><span><img caption="false" height="106" src="./../images/code修改.png" width="500"/></span></p>
<p><span>leftMotor=sim.getObjectHandle("<span style="color: #ff6600;">bubbleRob_leftMotor</span>") -- Handle of the left motor</span><br/><span>rightMotor=sim.getObjectHandle("<span style="color: #ff6600;">bubbleRob_rightMotor</span>") -- Handle of the right motor</span><br/><span>noseSensor=sim.getObjectHandle("<span style="color: #ff6600;">bubbleRob_sensingNose</span>") -- Handle of the proximity sensor<span> </span></span><br/>紅框內的名稱，如果大小寫或是名稱不同程式就沒辦法成功執行。</p>
<p><img caption="false" height="235" src="./../images/完成品.png" width="400"/></p>
<p>成功的bubbleRob在模擬時會自動避開路徑上的物件，並且畫面會有能調節速度的面板。</p>
<br />V-rep 動態模擬 << <a href='V-rep 動態模擬.html'>Previous</a> <a href='Vrep-2-1.html'>Next</a> >> Vrep-2-1</div></section></div></body></html>